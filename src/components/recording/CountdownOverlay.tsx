import { useEffect, useState, useRef, useCallback } from 'react';

interface CountdownOverlayProps {
  countdown: number | null;
}

// Path data extracted from SVG files
const SVG_DATA: Record<number, { viewBox: string; content: string }> = {
  3: {
    viewBox: '0 0 400 400',
    content:
      'M284.64,97.39c.27.25-.31,5.58,1.19,7.08-.92,3.15-2.58,10.4-6.17,11.39-.96.27-2.13-.12-3.08.2-2.32.79-5.11,3.35-7.22,4.8l4.92-2.73c.81-.17.75,1.16.54,1.64-.73,1.67-4.55,3.84-6.56,3.85.94.67.18,5.21-.03,5.4-.22.2-.99-.13-1.46.14-2.24,1.29-4.18,3.05-6.82,4.15-.86.35-2.08-.06-3.06.22-1.8.51-9.33,6.25-9.93,6.23-3.22-.13-1.37,1.54-4.9,4.07-3.82,2.73-8.02,3.74-10.36,7.1-2.14,3.08-5.07,3.18-7.18,4.86-1.25,1-.92,2.52-1.11,2.72-.26.28-6.22,2.04-6.45,2.29-.16.17-.12,2.81-1.73,3.23-1.75.46-3.16-3.7-2.69,2.18-2.05.47-.37-2.19-1.64-2.19-.92,0-.51,2.8-2.2,3.26-1.94.53-3.05-1.32-4.9-1.08l4.37,3.28c-5.93-.99-3.75,1.43-4.39,2.17-.54.62-3.6-2.14-4.35.56-.48,1.76,1.34,3.61,1.09,3.82-.17.15-3.54.89-4.37,1.09-.09,2.17,2.14,1,3.29.56,1.57-.6,6.42-3.67,7.08-3.67,6.7.04,4.23-1.25,7.74-2.27,2.46-.72,12.45-1.18,15.19-1.21,7.37-.1,11.7,3.14,17.64,6.46,7.02,3.91,6.92,3.74,11.88,9.98,5.39,6.78,10.24,12,13.55,20.33.35.9-.1,2.13.24,3.04.73,2.01,2.66,3.43,3.16,4.49,1.28,2.71-2.27.34-2.18,1.09.04.37,4.29,4.58,2.45,6.54,2.66,5.01-.45,3.23-1.36,3.87-.22.16.99,1.57,1.13,2.67.12.95.12,4.77-.07,4.92-.7.57-3.21-1.49-2.02,3.72.15.65,1.41,1.46.96,1.75-.42.27-1.72-.24-2.19.07-.42.28.82,1.01.83,1.57.01.93-1.84,2.95-1.85,3.31-.01.51,1.81,1.46,2.1,2.2.82,2.06-1.09,1.38-2.2,2.13-2.52,1.7-.15,3.61-.12,4.42.02.62-3.81,5.35-4.22,6,.13-.13-.19-.94.07-1.54.22-.51.84-.85.98-1.31.23-.75-.46-1.18-.52-1.53-.32-2.18.68-3.16.55-3.26-2.03-1.73-2.1,1.34-2.7,2.2-.55.8-3.33,2.73-2.76,3.26.75.7,2.57-1.49,3.28-.55l-3.28,4.92c.91-1.28,4.19-2.01,4.37-2.19-.12.19.22,1.29-.51,2.2-.91,1.14-2.35,2.09-3.31,3.26l-2.19-3.28c-.95,1.07,1.23,1.48.04,3.3-.35.53-2.22,2.39-2.77,2.77-.86.59-2.81-1.86-4.37,1.03l3.28,1.09c-1.16.91-2.13,2.49-3.26,3.29-5.02,3.55-9.25,5.77-14.21,9.85-3.8,3.14-6.16,2.83-10.94,4.89,2.43-2.26,1.18-1.45-.45-2.26-.92-.46-1.5-1.45-2.28-2.11-1.18,1.21,1.95,1.76,1.15,3.28-1.05,2,1.25,1.39,1.58,1.09-.2.09-1.54,2.9-2.8,3.26-1.06.31-2.69-1.73-4.3-1.07l.54,3.28c-3.24.92-1.79-1.76-2.19-2.19-.5-.52-1.69,1.39-2.19,1.7-.96.61-2.01-1.04-3.28-.61-.49,1.97,3.31.2,2.18,2.73-.32.71-3.45,2.6-3.82,2.6-1.59,0-2.04-2.88-3.95.52-1.69,3.01-2.04.5-3.56.78-.85.15-3.74,1.89-4.5,1.89-.93,0-7.18-.94-7.57-.83-2.44.68-2.41,5.88-7.2,1.06-.92,3.24,1.76,1.78,2.19,2.19,1.52,1.43-4.09,2.16-4.79,2.31-3.61.78-4.49-.24-5.44-.06-5.04.97-12.77,2.91-17.64,3.08-.27,0-3.04-2.72-4.46-3.08-1.98-.51-2.8,1.55-5.31-.13-1.98-1.33-1.5-2.92-1.74-3.18-.26-.3-1.88.16-2.73.01-2.57-.45-5.09-.8-7.49-2.36-4.13-2.68-1.55-4.04-1.76-4.22-.24-.2-1.98.29-3.32-.53-1.38-.84-3.51-3.17-4.33-3.86,1.2,1.19,3.38-.99,2.19-2.19s-3.38.99-2.19,2.19c-1.09-.92-3.14-1.95-3.86-3.24-.81-1.46-.27-2.38-.51-3.31,1.49.92,3.13,1.82,2.19-.54-.97-2.44-4.16-1.55-3.28-.55-3.26-3.41-5.91-7.11-5.62-11.47.04-.59-2.41-2.18-3.02-3.38-.84-1.66-1.3-5.06-1.2-7,2.08-.4.22,1.89,1.77,2.23,1.61.36.75.92,2.5,3.91,1.57,2.68,1.21.67,3.42,2.01,2.38,1.45,2.79,4.41,3.26,4.94.27.3,4.42-.2,5.89.12,2.39.51,4.53,3.88,5.64,4.19,5.35,1.48,13.3,4.02,18.47,4.5,1.99.19,8.81-1.71,11.1-2.17,1.14-.23,1.53,1.12,5.43.04.92-.25,2.38.08,2.57-.15.33-.39-.21-1.74.07-2.14.27-.4,1.09.78,1.76.96,3.59,1.01,6.43-4.31,9.71-5.09,6.43-1.52,26.83-16.93,33.32-22.63,3.43-3.02,5.67-7.39,8.72-9.88.92-.75,4.09-2.54,4.32-2.75.17-.15,1.04-4.12,1.21-4.27.77-.69.44.48,2.64-2.25,1.1-1.36,7.88-10.65,8.13-11.56.27-.96-.12-2.15.22-3.06.57-1.53,1.86-2.73,2.1-4.46.55-3.98.07-11.82-3.3-14.28-.79-.58-1.95-.4-2.14-.59-.37-.39.18-1.74-.1-2.06-.18-.21-2.49.05-3.65-.18-8.2-1.65-16.89-1.59-25.17.25-1.51.34-4.15,2.73-5.67,3.07-2.53.57-2.58-.19-4.34.89,1.2-.44,2.82.89.07,2.49-.79.46-.75-1.99-.55-2.19-1.11.76-2.59,1.38-3.85,1.93-.37.16-2.5-2.08-.52,1.34l-3.28-2.18c.2,3.14-2.5,4.62-3.86,6.54-.62.88-.43,2.04-.55,2.16-.25.25-1.7-.17-2.57.15-1.05.39-1.52,1.57-2.31,2.08-.51.33-.65-4.37-2.73-2.19-.25.26,1.83,2.63,1.09,3.27-.17.15-.98-.21-1.52.1-.95.54-1.46,1.43-2.43,1.96-2.71,1.48-3.84,2.24-5.89,3.92-2.02,1.66-6.71,7.8-9.2,7.11-.83-.23-1.59-2.02-2.24-1.98-4.58.32-2.57-.71-4.49-1.24-1.11-.3-2.32,1.46-2.59,1.06-.29-.43.24-1.79-.06-2.17-.29-.37-4.01.32-4.34-.03-.12-.13.14-.9-.12-1.49-1.83-4.16-4.11-7.01-7.54-9.98-.09-1.14,1.78-.26,2.19-.55,2.84-1.99-2.04-2.08-2.19-2.19-.61-.44,2.77-2.8,2.19-3.28-.37-.3-2.89.31-3.28-.01-.46-.38.86-1.06.85-1.61-.01-.59-1.23-1.38-.76-3.18.54-2.07,2.36-5.67,4.25-6.71,1.12-.62,2.24-.4,3.36-1.01,1.87-1.03,4.63-5.65,6.48-6.63,1.34-.72,3.14-.39,3.29-.54.16-.16.74-3.07,1.64-4.36,1.57-2.24,4.54-3,4.86-3.34.46-.48-.79-2.98,1.61-2.03.61.24,1.01.98,1.2.98,1.61.03,1.56-5.25,3.28-5.36.29-.02.98,1.46,2.73-.07l-3.28,4.92c1.67,2.29,4.67-3.13,4.34-4.3-.86-3.06-5.1-1.55,1.67-6.08,1.01-.67-.25,2.78,1.64,2.19-1.75-4.53.06-3.09,2.2-4.9,3.66-3.1,4.25-4.66,8.73-7.12-.18.2.24,1.04-.01,1.62-.23.51-1.59,1.23-1.08,1.66.61.52,6.19-1.46,4.37-3.28-.12-.12-3.17-.12-3.28,0,.32-.17,1.08-2.66,1.62-3.3,1.06-1.26,5.16-5.63,6.4-5.34,3.78.88-.07-.56.71-1.15.4-.3,1.76.25,2.12-.11.2-.2.15-2.78,1.78-3.21,1.21-.32,2.1,1.76,2.67.54-1.7-.37-.24-4.6.05-4.87.19-.17,1.36.07,2.14-.57,1.92-1.56,3.53-5.02,4.32-5.54,4.05-2.67,4.28-2.17,7.11-5.98,2.21-2.98,4.15-.99,4.96-5.96.17-1.07,2.12-.67,2.18-.58.2.3-.13,1.54,0,2.19,4.61-2.97.78-1.7,0-2.19-.29-.18,1.82-2.46,1.09-3.28-.4-.45-1.45,1.38-2.63,1.06-.88-.24-1.6-2.02-2.29-1.97-.38.03-.72.7-1.09.71-.49.01-1.27-1.36-1.59-.88-.33.48.19,1.83-.07,2.17-.55.73-2.78-1.18-3.81-1.17-1.87.02-6.2,2.09-6.56,2.07-.41-.02-1.02-1.14-2.06-.86-.94.26-1.6,1.86-2.31,2.14-2.42.97-1.36-1.82-1.64-2.18-1.07-1.41-1.02,2.04-1.13,2.16-.18.2-1.64-.1-2.57.15-.61.17-1.11.8-2.28,1.01-2.6.46-4.08-1.25-3.27,1.05,1.29,3.68-3.68.87-3.84,1.09-.2.27.24,1.74-1.08,2.78-1.26.99-4.24,1.43-4.41,1.6-.71.71,1.27,2.67,1.06,3.73-.18.94-2.27,3.78-3.23,4.48-2.59,1.9-6.34,2.5-9.17,3.95-.96.49-2.03,1.99-2.32,1.98-.38,0-4.32-2.6-5.63-3.06-.93-.32-2.33.02-2.53-.19-.21-.23-1.82-4.3-2.73-5.47-.97-1.25-2.52-.92-2.72-1.11-.17-.16-.82-3.11-1.68-4.33-1.37-1.96-5.7-3.96-5.97-4.96-.33-1.23.15-2.78-.16-4.21-.66-2.93-4.88-5.32-5.27-6.75-1.3-4.71-.39-9.01,1.01-13.57,2.43-.72,3.53,2.8,4.98,3.21,5.02,1.43,8.32-1.35,12.07-2,3.42-.59,7.38.22,10.85-.08,2.49-.22,7.26-2.05,9.75-2.26,13.07-1.15,37.67,2.3,50.19,6.72,1.88.67,4.94,3.22,6.67,3.22,3.14,0,5.98-4.3,8.18-6.1.76-.62,1.92-.38,2.13-.6.94-.97-1.47-2.74,3.89-2.29.69.06,1.43-1.79,2.19-1.77.45.01,1.64,1.66,1.64.33,0-.15-1.59-1.49-1.09-2.73,3.32-.52,5.86-2.44,9.32-2.23,1.07.07,1.81.92,2.15.92,1.75,0,4.2-1.33,7.54-.76,4.09.71,4.72,3.12,7.2,4.84.91.63,2.08.44,2.19.53h0Z'
  },
  2: {
    viewBox: '0 0 400 400',
    content:
      'M318.88,264.38c4.64.72,7.21,1.62,5.64,7.36-1.02,3.71-9.45,3.81-9.87,4.17-.46.4,2.44,3.16,1.65,4.95-2.39-.41-3.47,1.39-5.72,1.7-4.38.61-12.08-2.77-16.51-3.41-2.53-.37-5.73.64-8.19-.06-1.42-.41-2.31-2.78-3.53-3.14-1.68-.49-5.41,2.94-8.09,3.32-5.27.74-8.21-1.51-11.56-1.77-4.56-.35-9.48.37-14.09.06-.14-3.16,4.81-1.24,7.27-1.81,1.48-.34,3.8-2.66,5.27-2.99,2.25-.5,4.64.27,6.5-.1,2.96-.59,4.52-1.32,8.18-1.71,1.52-.16.99-3.21.85-3.3-.59-.41-3.35.87-3.28-.79,4.78-7.68-5.62-5.28-10.82-5.76-1.95-.18-3.16-1.83-4.89-1.84-1.49,0-6.57,1.94-7.99,1.63-6.87-1.5-5.54,1.64-6.84,1.53-4.36-.35-6.12.56-9.99.32-4.81-.3-7.24.75-13.2,1.55-7.06.95-13.41,4.28-21.25,3.18-.93-.13-2.09-2.18-2.62-1.49-.35.45-.07,4.03-2.5,4.96l-1.65-3.3c-3.41,5.35-5.72,3.91-9.96,4.9-12.73,2.97-23.06,8.23-34.84,13.04-3.51,1.43-9.3,1.06-10.5,5.18l3.3,1.65c-3.5.07-7.47,2.96-10.67,3.36-6.58.83-12.31-1.43-18.26-2.94-.52-.13-1.12.96-1.61.99-.35.02-4.58-3.93-5.07-4.72-.84-1.38.83-2.15.83-2.51.04-1.79-1.62.43-2.34.45-2.04.06-5.03-3.35-6.83-4.4-.74-.43-1.94.09-2.23-.19-.56-.53.41-4.34-.05-4.91-.35-.44-3.69,2.79-4.95,1.65-.38-.34,2.76-3.93,1.65-4.95-.28-.25-2.6.29-4-.12-4.35-1.29-1.91-9.09-2.64-9.75-.17-.16-1.97.16-3.31-.8-1.62-1.16-4.14-4.85-4.91-6.66-1.6-3.72,4.48-1.91,5.78-3.81,5.69,3.89,3.47-1.07,4.23-1.84.32-.32,2.11-.04,3.25-.86,1.92-1.38,1.37-3.8,1.68-4.15.33-.37,1.57.22,2.29-.14.88-.42,1.99-2.31,2.54-1.58.42.55-.39,2.67.08,3.26.3.39,9.51.37,9.82-.01.45-.55-.37-2.64.1-3.2.64-.75,14.55-1.46,17.1-1.89,3.75-.63,25.57-11.29,29.09-13.83,3.87-2.79,5.36-7.6,9.02-10.79,3.74-3.27,10.34-4.91,9.12-11.52,2.35-.93,1.43,6.8,4.95,3.3.53-.53-3.52-3.88-.8-4.96l4.05-.81c-.52-.47-1.22-1.02-1.24-1.67-.07-2.96,21.44-22.65,25.24-27.22,2.94-3.54,6.24-10.78,9.89-13.22,1.52-1.02-.39,4.2,2.47,3.3l.07-8.19c4.42.76,2.57-1.62,4.01-3.38,2.17-2.66,18.56-12.41,9.92-14.8-6.78-1.88-11.38,2-16.66,3.07-4.58.93-12.56.88-16.26,1.9-2.61.72-2.19,4.36-2.57,4.9-.42.59-2.27-2.07-3.94-1.62-1.33.36-5.94,3.9-9.99,4.97-8.06,2.13-25.33,8.94-32.9,13.33-2.42,1.4-5.29,5.85-6.9,6.3-1.92.53-4.21-.27-6.3.3-2.68.74-10.01,4.49-11.74,4.49-.53,0-1.09-1.08-1.81-1.18-3.44-.48-5.92.11-8.14-3.46-1.01-1.62-1.17-7.9-.75-8.26.14-.12,1.88.06,3.32-.8,2.27-1.36,5.23-4.44,7.56-5.66,8.23-4.3,17.11-7.39,25.43-12.54,6.33-3.92,10.84-4.85,15.48-7.64,7.39-4.44,10.44-8.84,20.18-12.83,12.43-5.09,24.39-8.66,37.6-11.93,9.12-2.26,12.65-9.29,25-8.12,1.77.17,2.68,1.41,3.49,1.56,1.67.3,2.56-1.26,3.08-1.3,1.16-.08,5.62,6.31,7.34,7.28,2.15,1.21,5.46,1.6,8.34,3.21,3.39,1.9,5.82,4.55,8.23,7.46.16.19-.24,1.94,1.65,1.65-.54.57,1.62,4.55-3.3,3.3-.14,1.07,2.21,3.3,2.48,3.3.33,0,5.36-3.88,5.77-3.3.36.51-.46,2.64.11,3.19.26.25,1.99.04,3.24.88,4.48,2.98-1.09,4.85-1.63,6.84-.12.45,1.42,7.47-.12,8.84-.22.2-1.93-.09-3.27.84-4.09,2.83-5.69,8.63-9.86,11.63-2.71,1.95-6.04,3.14-9.33,5.59-3.45,2.57-9.29,9.5-14.83,8.57-4.96-.83-6.45,8.86-7.31,9.67-.32.29-2.75-.24-4.14,1.68-.89,1.23-.56,3.01-.81,3.29-.23.25-6.24,2.02-6.52,1.72-.56-.59,1.32-3.93-1.66-3.3-.64,1.88,1.84,3.54.92,4.95-4.43,6.82-9.51,10.76-15.77,15.73-1.17.93-2.91.6-3.2.89-.87.87-6.4,11.33-9.17,11.23-.54-.02-1.59-1.85-3.2-1.41-2.46.67-3.46,6.21-5.03,8.27-2.24,2.94-6.1.02-5.82,3.26,2.44-.22,5.11.32,7.49.06,7.9-.86,10.73-.32,18.11-.33,1.21,0,5.97-2.79,8.19-3.08,4.73-.63,5.69,1.03,9.14,3.36-.6-6.2,1.88-2.26,4.36-1.77.91.18,10.2-1.61,11.1-1.43.84.17,1.41,1.48,3.48,1.59,1.86.09.3-2.45.92-3.35.33-.48,2.36,1.79,4.09,1.77,1.95-.03,7.42-1.76,9.86-1.82,4.5-.11,10.54-1.55,9.12,3.36,5.32-4.93,4.48-1.73,9.25-.18,6.45,2.1,8.64,2.42,14.62,1.77,3.73-.41,2.97.5,4.18,1.71-.47-.35-3.29-.51-3.3.83-.02,1.73,1.99.33,3.3.83.09.03-.22,1.19.84,1.62,3.67,1.48,2.03-2.72,2.48-3.28,1.54-1.93,6.66,4.37,8.23,5.83,1.04.97,2.88.57,3.2.89s-.07,2.13.89,3.2c2.4,2.69,6.42,5.54,7.35,9.2,1.85,7.34-.51,6.04-4.82,2.35-1.46,4.85,2.75,2.72,3.31,3.3.11.12.11,3.14,0,3.3-.57.73-4.02-4.38-3.3.82,2.06.93.91,3.9,2.57,4.16h.02Z'
  },
  1: {
    viewBox: '0 0 400 400',
    content:
      'M282.16,111.34c1.77,6.25-1.71,4.75-2.21,5.19-.52.47,1.09,4.58-1.79,3.45-.81-.32-1.79-2.94-2.9-1.74v3.48h3.48l-8.79,9.87c.68,5.1-9.16,8.81-12.07,11.65-.13.13.09,2.1-.58,3.49-.55,1.13-4.97,6.66-5.87,6.92-1.86.53-2.81-3.09-5.2-2.32l-3.48,2.9,5.8,3.48h-5.8c5.61,8.45-.29,3.3-1.16,4.06-2.43,2.11,2.6,2.37,2.32,2.9-.49.95-2.27,1.88-2.92,2.89-2.24,3.47-1.88,8.19-6.37,7,.49,1.44-.97,2.48-.96,2.87.02.46,1.22,1.13.92,2.23-.15.54-4.56,6.56-5.6,9.57-.35,1.02,0,2.54-.18,2.71-.37.36-3.06-.31-3.48.02-.49.38.89,1.19,1.09,1.9,1.01,3.61-4.42,9.68-4.38,10.27.38,5.56-3.64,10.62-5.82,16.44-2.71,7.24-4.23,15.74-7.26,22.93-.49,1.16-1.85,1.65-2.11,2.54-.4,1.39.24,4.8-.09,5.13-.21.21-4.62.56-5.8,1.17-.01,2.9,3.19-.34,3.48,0,.71.82-1.81,5.07-2.9,5.8-1.07.72.28-2.95-1.74-2.32-1.03,6.42,3.6,2.57,6.34,2.28,3.73-.39,8.48.33,11.65-.15.81-.12,1.56-1.58,2.32-2.13,1.2-.11.26,1.82.6,2.33.12.18,1.73-1,2.84-1.21,8.84-1.72,16.25-.56,25.47.18.53.04.93.87,1.29.88.65.03,1.57-1.87,2.32-2.17,2.52-1.01,1.42,1.84,1.78,2.27.73.86,8.38.88,9.77,1.26,1.13.31,2.45,3.76,4.1,5.18.64.55,3.31,2.29,4.2,2.79.57.33,1.43-.06,1.62.1.78.68-1.43,3.23-1.16,3.48.89.8,3.22-1.46,3.48-1.16,2.14,2.51-2.1,2.21-2.27,2.37-.2.17.13,4.51-1.79,4.58-.21,0-2.24-2-4.06-1.14-1.63,2.91,2.79,2.12,2.32,2.9-1.77,2.96-3.71-.25-4.65.58-.54.48,2.2,2.1.57,2.32l-2.86.57c1.61.74.45,2.63-.61,2.91-1.86.49-3.88-1.41-4.04-1.17-.29.44.26,1.86-.07,2.34-.29.41-1.56-1.68-2.24-.62l-.62,2.93-1.74-3.48c.34,1.16-.93,3.46-1.74,3.39-.3-.03-.68-.84-1.13-.77-2.19.35-4.84,2.23-7.01-.29-1.19-.09-.26,1.83-.59,2.32-.19.28-4.81-2.18-6.32-2.37-5.35-.67-13.48-.93-18.63-.92-1.42,0-3.44,1.25-6.97,1.23-4.45-.03-12.1,4.46-16.36,5.43-1.58.36-5.96-.19-6.25.13-.16.18.2,1.85-1.15,2.93-2.63,2.11-7.87,3.05-10.53,4.56-1.18.67-2.96,3.76-4.09,4.09-1.1.32-3.01-1.95-3.99-1.14-.38.31,2.27,1.76-.58,3.48-1.14.69.31-3.57-1.74-1.74-2.36,2.09-4.42,1.6-4.6,1.78-1.7,1.78.58,1.15-3.98,3.57-1.12.59-1.72,1.85-2.56,2.09-1.88.53-4.81.73-6.89,1.32-1.87-1.2-4.02-.85-5.67-1.32-1.41-.4-3.83-4.39-5.88-2.45-2.53-1.96-6.27-1.98-8.76-3.81-3.28-2.41-1.74-5.88-3.99-8.78-1.04-1.34-2.76-.99-2.93-1.14-.32-.29.16-3.5-.02-4.62-2.08-.46-.78,1.88-1.16,2.32-.57.66-3.2-.77-3.48-1.77-.29-1.03,2.01-4.67,2.24-5.93.21-1.15-.92-1.83-.94-2.19-.04-.82,4.12-3.71,5.17-3.98,1.94-.49,2.86.84,3.39.84,1.05,0,4.78-1.77,5.95-2.01,1.2-.24,2.38,1.65,4.44,1.05.95-.28,2.21-2.62,3.65-3.33,4.11-2.06,11.49-3.07,16.68-5.38,4.88-2.17,10.82-5.97,15.15-9.23,7.37-5.55,14.44-22.41,16.38-31.22,1.95-8.86,4.4-17.92,6.56-26.87,4-16.64,6.92-31.53,14.07-48.87,2.25-5.47,4.85-11.75,7.23-17.15,1.1-2.49,2.45-5.23,4.51-7.09-.79-1.73-2.12.04-3.07.41-6.97,2.69-13.29,3.51-20.58,4.96-1.28.25-4.88,1.9-5.94,1.9-.35,0-.98-.72-2.18-.77-.44-.02-.89.82-1.32.83-1.58.03-7.16-4.71-9.8-4.49-1.54-3.62-3.18-7.25-4.84-10.83-2.31-4.99-2.2-5.11-3.46-10.47-.32-1.35-3.28-5.29-3.28-5.92,0-.83,2.84-3.01,2.1-5.65-.2-.71-1.45-1.57-1.02-1.87.69-.47,3.49,1.12,2.29-2.89-.22-.72-1.36-1.15-1.74-1.74-1.41-2.23-.6-5.96,2.38-5.9.95.02,3.96,1.49,5.16.01.36-.44-.21-1.94.07-2.26.4-.47,5.51.94,5.73,1.2.16.18-.05,1.39.59,2.31,1.24,1.78,2.99.78,4.59,1.23.93.26,3.07,2.89,4.85,3.28,4.97,1.08,11.06-3.86,7.44,2.43,1.76-.79,3.67,1.02,4.07,1.03.62.01,1.15-1.39,1.7-1.65,1.63-.76,7.16-3.79,7.59-3.77.59.02,1.4,1.32,1.69.91.32-.45-.27-1.84.13-2.24.41-.41,1.87.18,2.26-.11.43-.32-1.61-1.89-1.17-2.29.34-.3,2.99.24,4.11.04,9.17-1.64,11.18-1.5,19.7-1.43.72,0,3.34-1.79,5.22-.93.37,2.3-2.9.68-3.48,1.16-.36.3,1.28,2.18,1.77,2.32,1.17.33,2.28-1.67,4.5-1.08,1.98.53,12.54,3.95,12.93,4.53.62.9.45,2.2.56,2.33.27.31,3.5-.16,4.62.02l-2.32,3.48c1.37-.62,3.16,1.53,3.48,1.16.31-.35-.96-4.78,1.74-3.48,1.19.57,3.73,4.37,4.69,5.78,1.98,2.91,2.62,3.12,5.19,5.22.74.6,3.24,3.04,3.4,3.59h0Z'
  }
};

type AnimationPhase = 'entering' | 'visible' | 'exiting' | 'hidden';

interface AnimatedNumberProps {
  number: number;
  phase: AnimationPhase;
  onAnimationEnd?: () => void;
}

function AnimatedNumber({ number, phase, onAnimationEnd }: AnimatedNumberProps) {
  const data = SVG_DATA[number];

  const getAnimation = () => {
    switch (phase) {
      case 'entering':
        return 'bounceIn 0.3s ease-out forwards';
      case 'exiting':
        return 'bounceOut 0.3s ease-in forwards';
      default:
        return 'none';
    }
  };

  if (!data) {
    // Fallback for numbers not in SVG_DATA
    return (
      <div
        className="text-[12rem] font-bold text-white"
        style={{
          textShadow: '4px 4px 8px rgba(0, 0, 0, 0.5), 8px 8px 16px rgba(0, 0, 0, 0.3)',
          animation: getAnimation()
        }}
        onAnimationEnd={onAnimationEnd}
      >
        {number}
      </div>
    );
  }

  return (
    <div
      style={{ animation: getAnimation() }}
      onAnimationEnd={onAnimationEnd}
    >
      <svg
        viewBox={data.viewBox}
        className="w-[480px] h-[480px]"
        style={{
          filter:
            'drop-shadow(4px 4px 8px rgba(0, 0, 0, 0.5)) drop-shadow(8px 8px 16px rgba(0, 0, 0, 0.3))'
        }}
      >
        <path d={data.content} fill="white" />
      </svg>
      <style>
        {`
          @keyframes bounceIn {
            0% {
              transform: translateY(100px) scale(0.8);
              opacity: 0;
            }
            60% {
              transform: translateY(-20px) scale(1.05);
              opacity: 1;
            }
            100% {
              transform: translateY(0) scale(1);
              opacity: 1;
            }
          }
          @keyframes bounceOut {
            0% {
              transform: translateY(0) scale(1);
              opacity: 1;
            }
            40% {
              transform: translateY(-20px) scale(1.05);
              opacity: 1;
            }
            100% {
              transform: translateY(100px) scale(0.8);
              opacity: 0;
            }
          }
        `}
      </style>
    </div>
  );
}

export function CountdownOverlay({ countdown }: CountdownOverlayProps) {
  const [visible, setVisible] = useState(false);
  const [displayCount, setDisplayCount] = useState<number | null>(null);
  const [phase, setPhase] = useState<AnimationPhase>('hidden');
  const prevCountdownRef = useRef<number | null>(null);

  const handleAnimationEnd = useCallback(() => {
    if (phase === 'entering') {
      setPhase('visible');
    } else if (phase === 'exiting') {
      setPhase('hidden');
      setDisplayCount(null);
      // Check if we need to show the next number
      if (countdown !== null) {
        setDisplayCount(countdown);
        setPhase('entering');
      } else {
        setVisible(false);
      }
    }
  }, [phase, countdown]);

  useEffect(() => {
    /* eslint-disable react-hooks/set-state-in-effect -- Responding to countdown prop change requires state updates */
    if (countdown !== null) {
      setVisible(true);
      if (displayCount === null) {
        // First number, enter directly
        setDisplayCount(countdown);
        setPhase('entering');
      } else if (displayCount !== countdown) {
        // New number, exit current first
        setPhase('exiting');
      }
    } else if (prevCountdownRef.current !== null && displayCount !== null) {
      // Countdown ended, exit the last number
      setPhase('exiting');
    }
    /* eslint-enable react-hooks/set-state-in-effect */

    prevCountdownRef.current = countdown;
  }, [countdown, displayCount]);

  if (!visible) return null;

  return (
    <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-50">
      <div className="text-center">
        {displayCount !== null && phase !== 'hidden' && (
          <AnimatedNumber
            key={displayCount}
            number={displayCount}
            phase={phase}
            onAnimationEnd={handleAnimationEnd}
          />
        )}
        {phase !== 'hidden' && (
          <p className="text-2xl text-gray-300 mt-4">Recording starting...</p>
        )}
      </div>
    </div>
  );
}
